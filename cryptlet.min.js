(function(){"use strict";var a={cipher:{},hash:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message},this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message},this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message},this.message=a}}};a.cipher.aes=function(b){this.h[0][0][0]||this.w();var c,d,e,f,g=this.h[0][4],h=this.h[1];c=b.length;var i=1;if(c!==4&&c!==6&&c!==8)throw new a.exception.invalid("invalid aes key size");this.a=[e=b.slice(0),f=[]];for(b=c;b<4*c+28;b++){d=e[b-1];if(b%c===0||c===8&&b%c===4)d=g[d>>>24]<<24^g[d>>16&255]<<16^g[d>>8&255]<<8^g[d&255],b%c===0&&(d=d<<8^d>>>24^i<<24,i=i<<1^(i>>7)*283);e[b]=e[b-c]^d}for(c=0;b;c++,b--)d=e[c&3?b:b-4],f[c]=b<=4||c<4?d:h[0][g[d>>>24]]^h[1][g[d>>16&255]]^h[2][g[d>>8&255]]^h[3][g[d&255]]},a.cipher.aes.prototype={encrypt:function(a){return this.H(a,0)},decrypt:function(a){return this.H(a,1)},h:[[[],[],[],[],[]],[[],[],[],[],[]]],w:function(){var a=this.h[0],b=this.h[1],c=a[4],d=b[4],e,f,g,h=[],i=[],j,k,l,m;for(e=0;e<256;e++)i[(h[e]=e<<1^(e>>7)*283)^e]=e;for(f=g=0;!c[f];f^=j||1,g=i[g]||1){l=g^g<<1^g<<2^g<<3^g<<4,l=l>>8^l&255^99,c[f]=l,d[l]=f,k=h[e=h[j=h[f]]],m=k*16843009^e*65537^j*257^f*16843008,k=h[l]*257^l*16843008;for(e=0;e<4;e++)a[e][f]=k=k<<24^k>>>8,b[e][l]=m=m<<24^m>>>8}for(e=0;e<5;e++)a[e]=a[e].slice(0),b[e]=b[e].slice(0)},H:function(b,c){if(b.length!==4)throw new a.exception.invalid("invalid aes block size");var d=this.a[c],e=b[0]^d[0],f=b[c?3:1]^d[1],g=b[2]^d[2];b=b[c?1:3]^d[3];var h,i,j,k=d.length/4-2,l,m=4,n=[0,0,0,0];h=this.h[c];var o=h[0],p=h[1],q=h[2],r=h[3],s=h[4];for(l=0;l<k;l++)h=o[e>>>24]^p[f>>16&255]^q[g>>8&255]^r[b&255]^d[m],i=o[f>>>24]^p[g>>16&255]^q[b>>8&255]^r[e&255]^d[m+1],j=o[g>>>24]^p[b>>16&255]^q[e>>8&255]^r[f&255]^d[m+2],b=o[b>>>24]^p[e>>16&255]^q[f>>8&255]^r[g&255]^d[m+3],m+=4,e=h,f=i,g=j;for(l=0;l<4;l++)n[c?3&-l:l]=s[e>>>24]<<24^s[f>>16&255]<<16^s[g>>8&255]<<8^s[b&255]^d[m++],h=e,e=f,f=g,g=b,b=h;return n}},a.bitArray={bitSlice:function(b,c,d){return b=a.bitArray.P(b.slice(c/32),32-(c&31)).slice(1),d===undefined?b:a.bitArray.clamp(b,d-c)},concat:function(b,c){if(b.length===0||c.length===0)return b.concat(c);var d=b[b.length-1],e=a.bitArray.getPartial(d);return e===32?b.concat(c):a.bitArray.P(c,e,d|0,b.slice(0,b.length-1))},bitLength:function(b){var c=b.length;return c===0?0:(c-1)*32+a.bitArray.getPartial(b[c-1])},clamp:function(b,c){if(b.length*32<c)return b;b=b.slice(0,Math.ceil(c/32));var d=b.length;return c&=31,d>0&&c&&(b[d-1]=a.bitArray.partial(c,b[d-1]&2147483648>>c-1,1)),b},partial:function(a,b,c){return a===32?b:(c?b|0:b<<32-a)+a*1099511627776},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(b,c){if(a.bitArray.bitLength(b)!==a.bitArray.bitLength(c))return!1;var d=0,e;for(e=0;e<b.length;e++)d|=b[e]^c[e];return d===0},P:function(b,c,d,e){var f;f=0,e===undefined&&(e=[]);for(;c>=32;c-=32)e.push(d),d=0;if(c===0)return e.concat(b);for(f=0;f<b.length;f++)e.push(d|b[f]>>>c),d=b[f]<<32-c;return f=b.length?b[b.length-1]:0,b=a.bitArray.getPartial(f),e.push(a.bitArray.partial(c+b&31,c+b>32?d:e.pop(),1)),e},k:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}},a.codec.utf8String={fromBits:function(b){var c="",d=a.bitArray.bitLength(b),e,f;for(e=0;e<d/8;e++)(e&3)===0&&(f=b[e/4]),c+=String.fromCharCode(f>>>24),f<<=8;return decodeURIComponent(escape(c))},toBits:function(b){b=unescape(encodeURIComponent(b));var c=[],d,e=0;for(d=0;d<b.length;d++)e=e<<8|b.charCodeAt(d),(d&3)===3&&(c.push(e),e=0);return d&3&&c.push(a.bitArray.partial(8*(d&3),e)),c}},a.codec.hex={fromBits:function(b){var c="",d;for(d=0;d<b.length;d++)c+=((b[d]|0)+0xf00000000000).toString(16).substr(4);return c.substr(0,a.bitArray.bitLength(b)/4)},toBits:function(b){var c,d=[],e;b=b.replace(/\s|0x/g,""),e=b.length,b+="00000000";for(c=0;c<b.length;c+=8)d.push(parseInt(b.substr(c,8),16)^0);return a.bitArray.clamp(d,e*4)}},a.codec.base64={D:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(b,c){var d="",e,f=0,g=a.codec.base64.D,h=0,i=a.bitArray.bitLength(b);for(e=0;d.length*6<i;)d+=g.charAt((h^b[e]>>>f)>>>26),f<6?(h=b[e]<<6-f,f+=26,e++):(h<<=6,f-=6);for(;d.length&3&&!c;)d+="=";return d},toBits:function(b){b=b.replace(/\s|=/g,"");var c=[],d,e=0,f=a.codec.base64.D,g=0,h;for(d=0;d<b.length;d++){h=f.indexOf(b.charAt(d));if(h<0)throw new a.exception.invalid("this isn't base64!");e>26?(e-=26,c.push(g^h>>>e),g=h<<32-e):(e+=6,g^=h<<32-e)}return e&56&&c.push(a.bitArray.partial(e&56,g,1)),c}},a.hash.sha256=function(a){this.a[0]||this.w(),a?(this.n=a.n.slice(0),this.i=a.i.slice(0),this.e=a.e):this.reset()},a.hash.sha256.hash=function(b){return(new a.hash.sha256).update(b).finalize()},a.hash.sha256.prototype={blockSize:512,reset:function(){return this.n=this.N.slice(0),this.i=[],this.e=0,this},update:function(b){typeof b=="string"&&(b=a.codec.utf8String.toBits(b));var c,d=this.i=a.bitArray.concat(this.i,b);c=this.e,b=this.e=c+a.bitArray.bitLength(b);for(c=512+c&-512;c<=b;c+=512)this.C(d.splice(0,16));return this},finalize:function(){var b,c=this.i,d=this.n;c=a.bitArray.concat(c,[a.bitArray.partial(1,1)]);for(b=c.length+2;b&15;b++)c.push(0);c.push(Math.floor(this.e/4294967296));for(c.push(this.e|0);c.length;)this.C(c.splice(0,16));return this.reset(),d},N:[],a:[],w:function(){function a(a){return(a-Math.floor(a))*4294967296|0}var b=0,c=2,d;a:for(;b<64;c++){for(d=2;d*d<=c;d++)if(c%d===0)continue a;b<8&&(this.N[b]=a(Math.pow(c,.5))),this.a[b]=a(Math.pow(c,1/3)),b++}},C:function(a){var b,c,d=a.slice(0),e=this.n,f=this.a,g=e[0],h=e[1],i=e[2],j=e[3],k=e[4],l=e[5],m=e[6],n=e[7];for(a=0;a<64;a++)a<16?b=d[a]:(b=d[a+1&15],c=d[a+14&15],b=d[a&15]=(b>>>7^b>>>18^b>>>3^b<<25^b<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+d[a&15]+d[a+9&15]|0),b=b+n+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(m^k&(l^m))+f[a],n=m,m=l,l=k,k=j+b|0,j=i,i=h,h=g,g=b+(h&i^j&(h^i))+(h>>>2^h>>>13^h>>>22^h<<30^h<<19^h<<10)|0;e[0]=e[0]+g|0,e[1]=e[1]+h|0,e[2]=e[2]+i|0,e[3]=e[3]+j|0,e[4]=e[4]+k|0,e[5]=e[5]+l|0,e[6]=e[6]+m|0,e[7]=e[7]+n|0}},a.mode.ccm={name:"ccm",encrypt:function(b,c,d,e,f){var g,h=c.slice(0),i=a.bitArray,j=i.bitLength(d)/8,k=i.bitLength(h)/8;f=f||64,e=e||[];if(j<7)throw new a.exception.invalid("ccm: iv must be at least 7 bytes");for(g=2;g<4&&k>>>8*g;g++);return g<15-j&&(g=15-j),d=i.clamp(d,8*(15-g)),c=a.mode.ccm.G(b,c,d,e,f,g),h=a.mode.ccm.I(b,h,d,c,f,g),i.concat(h.data,h.tag)},decrypt:function(b,c,d,e,f){f=f||64,e=e||[];var g=a.bitArray,h=g.bitLength(d)/8,i=g.bitLength(c),j=g.clamp(c,i-f),k=g.bitSlice(c,i-f);i=(i-f)/8;if(h<7)throw new a.exception.invalid("ccm: iv must be at least 7 bytes");for(c=2;c<4&&i>>>8*c;c++);c<15-h&&(c=15-h),d=g.clamp(d,8*(15-c)),j=a.mode.ccm.I(b,j,d,k,f,c),b=a.mode.ccm.G(b,j.data,d,e,f,c);if(!g.equal(j.tag,b))throw new a.exception.corrupt("ccm: tag doesn't match");return j.data},G:function(b,c,d,e,f,g){var h=[],i=a.bitArray,j=i.k;f/=8;if(f%2||f<4||f>16)throw new a.exception.invalid("ccm: invalid tag length");if(e.length>4294967295||c.length>4294967295)throw new a.exception.bug("ccm: can't deal with 4GiB or more data");g=[i.partial(8,(e.length?64:0)|f-2<<2|g-1)],g=i.concat(g,d),g[3]|=i.bitLength(c)/8,g=b.encrypt(g);if(e.length){d=i.bitLength(e)/8,d<=65279?h=[i.partial(16,d)]:d<=4294967295&&(h=i.concat([i.partial(16,65534)],[d])),h=i.concat(h,e);for(e=0;e<h.length;e+=4)g=b.encrypt(j(g,h.slice(e,e+4)))}for(e=0;e<c.length;e+=4)g=b.encrypt(j(g,c.slice(e,e+4)));return i.clamp(g,f*8)},I:function(b,c,d,e,f,g){var h,i=a.bitArray;h=i.k;var j=c.length,k=i.bitLength(c);d=i.concat([i.partial(8,g-1)],d).concat([0,0,0]).slice(0,4),e=i.bitSlice(h(e,b.encrypt(d)),0,f);if(!j)return{tag:e,data:[]};for(h=0;h<j;h+=4)d[3]++,f=b.encrypt(d),c[h]^=f[0],c[h+1]^=f[1],c[h+2]^=f[2],c[h+3]^=f[3];return{tag:e,data:i.clamp(c,k)}}},a.mode.ocb2={name:"ocb2",encrypt:function(b,c,d,e,f,g){if(a.bitArray.bitLength(d)!==128)throw new a.exception.invalid("ocb iv must be 128 bits");var h,i=a.mode.ocb2.A,j=a.bitArray,k=j.k,l=[0,0,0,0];d=i(b.encrypt(d));var m,n=[];e=e||[],f=f||64;for(h=0;h+4<c.length;h+=4)m=c.slice(h,h+4),l=k(l,m),n=n.concat(k(d,b.encrypt(k(d,m)))),d=i(d);return m=c.slice(h),c=j.bitLength(m),h=b.encrypt(k(d,[0,0,0,c])),m=j.clamp(k(m,h),c),l=k(l,k(m,h)),l=b.encrypt(k(l,k(d,i(d)))),e.length&&(l=k(l,g?e:a.mode.ocb2.pmac(b,e))),n.concat(j.concat(m,j.clamp(l,f)))},decrypt:function(b,c,d,e,f,g){if(a.bitArray.bitLength(d)!==128)throw new a.exception.invalid("ocb iv must be 128 bits");f=f||64;var h=a.mode.ocb2.A,i=a.bitArray,j=i.k,k=[0,0,0,0],l=h(b.encrypt(d)),m,n,o=a.bitArray.bitLength(c)-f,p=[];e=e||[];for(d=0;d+4<o/32;d+=4)m=j(l,b.decrypt(j(l,c.slice(d,d+4)))),k=j(k,m),p=p.concat(m),l=h(l);n=o-d*32,m=b.encrypt(j(l,[0,0,0,n])),m=j(m,i.clamp(c.slice(d),n)),k=j(k,m),k=b.encrypt(j(k,j(l,h(l)))),e.length&&(k=j(k,g?e:a.mode.ocb2.pmac(b,e)));if(!i.equal(i.clamp(k,f),i.bitSlice(c,o)))throw new a.exception.corrupt("ocb: tag doesn't match");return p.concat(i.clamp(m,n))},pmac:function(b,c){var d,e=a.mode.ocb2.A,f=a.bitArray,g=f.k,h=[0,0,0,0],i=b.encrypt([0,0,0,0]);i=g(i,e(e(i)));for(d=0;d+4<c.length;d+=4)i=e(i),h=g(h,b.encrypt(g(i,c.slice(d,d+4))));return c=c.slice(d),f.bitLength(c)<128&&(i=g(i,e(i)),c=f.concat(c,[-2147483648])),h=g(h,c),b.encrypt(g(e(g(i,e(i))),h))},A:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^(a[0]>>>31)*135]}},a.misc.hmac=function(b,c){this.M=c=c||a.hash.sha256;var d=[[],[]],e=c.prototype.blockSize/32;this.l=[new c,new c],b.length>e&&(b=c.hash(b));for(c=0;c<e;c++)d[0][c]=b[c]^909522486,d[1][c]=b[c]^1549556828;this.l[0].update(d[0]),this.l[1].update(d[1])},a.misc.hmac.prototype.encrypt=a.misc.hmac.prototype.mac=function(a,b){return a=(new this.M(this.l[0])).update(a,b).finalize(),(new this.M(this.l[1])).update(a).finalize()},a.misc.pbkdf2=function(b,c,d,e,f){d=d||1e3;if(e<0||d<0)throw a.exception.invalid("invalid params to pbkdf2");typeof b=="string"&&(b=a.codec.utf8String.toBits(b)),f=f||a.misc.hmac,b=new f(b);var g,h,i,j,k=[],l=a.bitArray;for(j=1;32*k.length<(e||1);j++){f=g=b.encrypt(l.concat(c,[j]));for(h=1;h<d;h++){g=b.encrypt(g);for(i=0;i<g.length;i++)f[i]^=g[i]}k=k.concat(f)}return e&&(k=l.clamp(k,e)),k},a.random={randomWords:function(b,c){var d=[];c=this.isReady(c);var e;if(c===0)throw new a.exception.notready("generator isn't seeded");c&2&&this.U(!(c&1));for(c=0;c<b;c+=4)(c+1)%65536===0&&this.L(),e=this.u(),d.push(e[0],e[1],e[2],e[3]);return this.L(),d.slice(0,b)},setDefaultParanoia:function(a){this.t=a},addEntropy:function(b,c,d){d=d||"user";var e,f,g=(new Date).valueOf(),h=this.q[d],i=this.isReady();e=this.F[d],e===undefined&&(e=this.F[d]=this.R++),h===undefined&&(h=this.q[d]=0),this.q[d]=(this.q[d]+1)%this.b.length;switch(typeof b){case"number":break;case"object":if(c===undefined)for(d=c=0;d<b.length;d++)for(f=b[d];f>0;)c++,f>>>=1;this.b[h].update([e,this.J++,2,c,g,b.length].concat(b));break;case"string":c===undefined&&(c=b.length),this.b[h].update([e,this.J++,3,c,g,b.length]),this.b[h].update(b);break;default:throw new a.exception.bug("random: addEntropy only supports number, array or string")}this.j[h]+=c,this.f+=c,i===0&&(this.isReady()!==0&&this.K("seeded",Math.max(this.g,this.f)),this.K("progress",this.getProgress()))},isReady:function(a){return a=this.B[a!==undefined?a:this.t],this.g&&this.g>=a?this.j[0]>80&&(new Date).valueOf()>this.O?3:1:this.f>=a?2:0},getProgress:function(a){return a=this.B[a?a:this.t],this.g>=a?(1)[0]:this.f>a?(1)[0]:this.f/a},startCollectors:function(){if(!this.m){if(window.addEventListener)window.addEventListener("load",this.o,!1),window.addEventListener("mousemove",this.p,!1);else if(document.attachEvent)document.attachEvent("onload",this.o),document.attachEvent("onmousemove",this.p);else throw new a.exception.bug("can't attach event");this.m=!0}},stopCollectors:function(){this.m&&(window.removeEventListener?(window.removeEventListener("load",this.o),window.removeEventListener("mousemove",this.p)):window.detachEvent&&(window.detachEvent("onload",this.o),window.detachEvent("onmousemove",this.p)),this.m=!1)},addEventListener:function(a,b){this.r[a][this.Q++]=b},removeEventListener:function(a,b){var c;a=this.r[a];var d=[];for(c in a)a.hasOwnProperty[c]&&a[c]===b&&d.push(c);for(b=0;b<d.length;b++)c=d[b],delete a[c]},b:[new a.hash.sha256],j:[0],z:0,q:{},J:0,F:{},R:0,g:0,f:0,O:0,a:[0,0,0,0,0,0,0,0],d:[0,0,0,0],s:undefined,t:6,m:!1,r:{progress:{},seeded:{}},Q:0,B:[0,48,64,96,128,192,256,384,512,768,1024],u:function(){for(var a=0;a<4;a++){this.d[a]=this.d[a]+1|0;if(this.d[a])break}return this.s.encrypt(this.d)},L:function(){this.a=this.u().concat(this.u()),this.s=new a.cipher.aes(this.a)},T:function(b){this.a=a.hash.sha256.hash(this.a.concat(b)),this.s=new a.cipher.aes(this.a);for(b=0;b<4;b++){this.d[b]=this.d[b]+1|0;if(this.d[b])break}},U:function(b){var c=[],d=0,e;this.O=c[0]=(new Date).valueOf()+3e4;for(e=0;e<16;e++)c.push(Math.random()*4294967296|0);for(e=0;e<this.b.length;e++){c=c.concat(this.b[e].finalize()),d+=this.j[e],this.j[e]=0;if(!b&&this.z&1<<e)break}this.z>=1<<this.b.length&&(this.b.push(new a.hash.sha256),this.j.push(0)),this.f-=d,d>this.g&&(this.g=d),this.z++,this.T(c)},p:function(b){a.random.addEntropy([b.x||b.clientX||b.offsetX,b.y||b.clientY||b.offsetY],2,"mouse")},o:function(){a.random.addEntropy(new Date,2,"loadtime")},K:function(b,c){var d;b=a.random.r[b];var e=[];for(d in b)b.hasOwnProperty(d)&&e.push(b[d]);for(d=0;d<e.length;d++)e[d](c)}},a.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},encrypt:function(b,c,d,e){d=d||{},e=e||{};var f=a.json,g=f.c({iv:a.random.randomWords(4,0)},f.defaults);f.c(g,d),typeof g.salt=="string"&&(g.salt=a.codec.base64.toBits(g.salt)),typeof g.iv=="string"&&(g.iv=a.codec.base64.toBits(g.iv));if(!a.mode[g.mode]||!a.cipher[g.cipher]||typeof b=="string"&&g.iter<=100||g.ts!==64&&g.ts!==96&&g.ts!==128||g.ks!==128&&g.ks!==192&&g.ks!==256||g.iv.length<2||g.iv.length>4)throw new a.exception.invalid("json encrypt: invalid parameters");return typeof b=="string"&&(d=a.misc.cachedPbkdf2(b,g),b=d.key.slice(0,g.ks/32),g.salt=d.salt),typeof c=="string"&&(c=a.codec.utf8String.toBits(c)),d=new a.cipher[g.cipher](b),f.c(e,g),e.key=b,g.ct=a.mode[g.mode].encrypt(d,c,g.iv,g.adata,g.tag),f.encode(f.V(g,f.defaults))},decrypt:function(b,c,d,e){d=d||{},e=e||{};var f=a.json;c=f.c(f.c(f.c({},f.defaults),f.decode(c)),d,!0),typeof c.salt=="string"&&(c.salt=a.codec.base64.toBits(c.salt)),typeof c.iv=="string"&&(c.iv=a.codec.base64.toBits(c.iv));if(!a.mode[c.mode]||!a.cipher[c.cipher]||typeof b=="string"&&c.iter<=100||c.ts!==64&&c.ts!==96&&c.ts!==128||c.ks!==128&&c.ks!==192&&c.ks!==256||!c.iv||c.iv.length<2||c.iv.length>4)throw new a.exception.invalid("json decrypt: invalid parameters");return typeof b=="string"&&(d=a.misc.cachedPbkdf2(b,c),b=d.key.slice(0,c.ks/32),c.salt=d.salt),d=new a.cipher[c.cipher](b),d=a.mode[c.mode].decrypt(d,c.ct,c.iv,c.adata,c.tag),f.c(e,c),e.key=b,a.codec.utf8String.fromBits(d)},encode:function(b){var c,d="{",e="";for(c in b)if(b.hasOwnProperty(c)){if(!c.match(/^[a-z0-9]+$/i))throw new a.exception.invalid("json encode: invalid property name");d+=e+c+":",e=",";switch(typeof b[c]){case"number":case"boolean":d+=b[c];break;case"string":d+='"'+escape(b[c])+'"';break;case"object":d+='"'+a.codec.base64.fromBits(b[c],1)+'"';break;default:throw new a.exception.bug("json encode: unsupported type")}}return d+"}"},decode:function(b){b=b.replace(/\s/g,"");if(!b.match(/^\{.*\}$/))throw new a.exception.invalid("json decode: this isn't json!");b=b.replace(/^\{|\}$/g,"").split(/,/);var c={},d,e;for(d=0;d<b.length;d++){if(!(e=b[d].match(/^([a-z][a-z0-9]*):(?:(\d+)|"([a-z0-9+\/%*_.@=\-]*)")$/i)))throw new a.exception.invalid("json decode: this isn't json!");c[e[1]]=e[2]?parseInt(e[2],10):e[1].match(/^(ct|salt|iv)$/)?a.codec.base64.toBits(e[3]):unescape(e[3])}return c},c:function(b,c,d){b===undefined&&(b={});if(c===undefined)return b;var e;for(e in c)if(c.hasOwnProperty(e)){if(d&&b[e]!==undefined&&b[e]!==c[e])throw new a.exception.invalid("required parameter overridden");b[e]=c[e]}return b},V:function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&a[d]!==b[d]&&(c[d]=a[d]);return c},W:function(a,b){var c={},d;for(d=0;d<b.length;d++)a[b[d]]!==undefined&&(c[b[d]]=a[b[d]]);return c}},a.encrypt=a.json.encrypt,a.decrypt=a.json.decrypt,a.misc.S={},a.misc.cachedPbkdf2=function(b,c){var d=a.misc.S,e;return c=c||{},e=c.iter||1e3,d=d[b]=d[b]||{},e=d[e]=d[e]||{firstSalt:c.salt&&c.salt.length?c.salt.slice(0):a.random.randomWords(2,0)},d=c.salt===undefined?e.firstSalt:c.salt,e[d]=e[d]||a.misc.pbkdf2(b,d,c.iter),{key:e[d].slice(0),salt:d.slice(0)}};var b="cryptlet-container",c=document.getElementById("canvas_frame"),d=c.contentDocument||c.contentWindow.document,e=function(a){throw alert(a),a},f=function(){var b=prompt("Enter a password, please!"),c=d.getElementsByName("body")[0];b===""?e("You must enter a password."):b.length<12&&e("You must enter a longer password."),c.value=a.encrypt(b,c.value)},g=function(){var b=prompt("Enter a password, please!"),c=this.parentNode.firstChild;console.log("decrypting: "+c.textContent),c.textContent=a.decrypt(b,c.textContent)},h=function(){var a=d.getElementsByTagName("div"),c=null;for(var g=0;g<a.length;g++){var h=a[g];if(h.firstChild!==null){var i=h.firstChild;if(i.nodeType===3&&i.nodeValue==="Discard"){c=h;break}}}c===null&&e("Could not find the Discard button");var j=d.createElement("span"),k=d.createElement("div");j.className=b,k.setAttribute("role","button"),k.className=c.className,k.appendChild(d.createTextNode("Encrypt")),k.onclick=f,j.appendChild(k),c.parentNode.insertBefore(j)},i=function(){var a=d.getElementsByTagName("div"),c=null,e=null;for(var f=0;f<a.length;f++)if(a[f].getAttribute("role")==="main"){c=a[f];break}var h=c.getElementsByTagName("div"),i=[];for(var f=0;f<h.length;f++){var j=h[f];j.firstChild!==null&&j.firstChild.nodeType===3&&(j.getAttribute("role")==="button"?e=j.className:i.push(j))}for(var f=0;f<i.length;f++){var k=d.createElement("span"),l=d.createElement("div");k.className=b,k.appendChild(l),e!==null&&(l.className=e),l.appendChild(document.createTextNode("Decrypt")),l.setAttribute("role","button"),k.onclick=g,i[f].parentNode.insertBefore(k)}},j=function(){var a=document.location.hash,c=d.getElementsByClassName(b);if(c.length>0)for(var e=0;e<c.length;e++)c[e].parentNode.removeChild(c[e]);a.indexOf("#compose")===0||a.indexOf("#drafts")===0?h():a.indexOf("#inbox/")===0&&i()};window.onhashchange=j})();